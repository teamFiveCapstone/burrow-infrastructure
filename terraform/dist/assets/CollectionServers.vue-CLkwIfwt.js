import{d as U,A as w,B as A,R as g,b2 as j,E as B,c as n,b as i,g as y,U as N,e as o,f as k,aN as E,x as z,a9 as I,r as P,j as f,bN as R,X as T,h as r,aO as V,t as $,S as h,aZ as D,T as S,a0 as F,af as M}from"./index-6FRNjKLB.js";import{w as O}from"./DeleteSidebarListElement.vue-Doxr0_fl.js";import{q as L}from"./Form.vue-C9rNRhd4.js";import"./ViewLayoutSection.vue-COiv4Cec.js";const W=U({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(C){const t=C,{activeWorkspaceCollections:d}=w(),{servers:p,serverMutators:v}=A(),c=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],e=g(()=>{const l=d.value.find(a=>a.uid===t.collectionId);return p[l&&typeof t.serverUid=="string"&&t.serverUid==="default"?l.servers[0]??"":l?.servers.find(a=>a===t.serverUid)??""]}),m=g(()=>e.value?.url?e.value.url.match(j.PATH)?.map(l=>l.slice(1,-1))??[]:[]);B(m,l=>{if(!e.value)return;const a=e.value.variables?{...e.value.variables}:{};Object.keys(a).forEach(s=>{l.includes(s)||delete a[s]}),l.forEach(s=>{a[s]||(a[s]={default:""})}),v.edit(e.value.uid,"variables",a)},{immediate:!0});const b=(l,a)=>{!d.value||!e.value||v.edit(e.value.uid,l,a)},x=(l,a)=>{if(!e.value)return;const s=e.value.variables||{};s[l]={...s[l],default:a},v.edit(e.value.uid,"variables",s)};return(l,a)=>(i(),n("div",{class:z(["divide-0.5 flex w-full flex-col divide-y rounded-b-lg text-sm",e.value?.variables&&"bg-b-1"])},[e.value?(i(),n(N,{key:0},[o(L,{data:e.value,onUpdate:b,options:c},null,8,["data"]),e.value.variables?(i(),k(E,{key:0,variables:e.value.variables,"onUpdate:variable":x},null,8,["variables"])):y("",!0)],64)):y("",!0)],2))}}),q={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},X={class:"flex flex-col gap-4"},Y={class:"rounded-lg border"},G={class:"bg-b-2 flex items-start justify-between rounded-t-lg py-1 pr-1 pl-3 text-sm"},H={key:1,class:"self-center"},Z={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},le=U({__name:"CollectionServers",setup(C){const{activeCollection:t}=w(),{servers:d,events:p,serverMutators:v}=A(),c=I(),e=P(null),m=g(()=>!d||!t.value?.servers?[]:Object.values(d).filter(a=>t.value?.servers.includes(a.uid))),b=()=>p.commandPalette.emit({commandName:"Add Server"}),x=()=>{!t.value?.uid||!e.value||(v.delete(e.value,t.value.uid),c.hide())},l=a=>{e.value=a,c.show()};return(a,s)=>(i(),n("div",q,[f("div",X,[s[2]||(s[2]=R('<div class="flex items-start justify-between gap-2"><div class="flex flex-col gap-2"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(i(!0),n(N,null,T(m.value,(u,_)=>(i(),n("div",{key:u.uid},[f("div",Y,[f("div",G,[u.description?(i(),k(r(V),{key:0,class:"self-center",value:u.description},null,8,["value"])):(i(),n("span",H,"Server "+$(_+1),1)),o(r(S),{class:"hover:bg-b-3 hover:text-c-1 h-fit p-1.25",variant:"ghost",onClick:J=>l(u.uid)},{default:h(()=>[o(r(D),{class:"size-3.5"})]),_:1},8,["onClick"])]),r(t)?(i(),k(W,{key:0,collectionId:r(t).uid,serverUid:u.uid},null,8,["collectionId","serverUid"])):y("",!0)])]))),128)),f("div",Z,[o(r(S),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:b},{default:h(()=>[o(r(F),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),s[1]||(s[1]=f("span",null,"Add Server",-1))]),_:1})])]),o(r(M),{size:"xxs",state:r(c),title:`Delete ${e.value?r(d)[e.value]?.url:"Server"}`},{default:h(()=>[o(O,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:s[0]||(s[0]=u=>r(c).hide()),onDelete:x})]),_:1},8,["state","title"])]))}});export{le as default};
