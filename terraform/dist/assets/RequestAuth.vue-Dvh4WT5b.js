import{d as E,B as N,f as S,b as n,S as a,j as w,t as T,e as c,h as s,T as B,Z as b,af as re,bQ as F,bR as P,a4 as Q,R as I,bS as ne,bT as ce,x as R,g,n as Y,a0 as ie,bU as ue,c as y,U as C,X as D,aX as V,aV as J,aY as de,aq as Z,al as M,k as A,bV as pe,bf as me,bW as fe,L as he,bX as ye,r as j,o as ve,bY as be,bZ as H,a9 as G,E as X,a_ as we,ah as ee,b_ as xe,b$ as ke,c0 as ge,c1 as Ve,c2 as Se,c3 as _e,_ as $e,C as Ue,aZ as Ce,b0 as Ae}from"./index-6FRNjKLB.js";const Oe={class:"text-c-2 mb-4 text-sm leading-normal"},ze={class:"flex justify-between gap-2"},te=E({__name:"DeleteRequestAuthModal",props:{state:{},scheme:{}},emits:["close","delete"],setup(l,{emit:U}){const f=l,h=U,{securitySchemeMutators:x}=N(),k=()=>{f.scheme?.id&&x.delete(f.scheme.id),h("delete")};return(o,p)=>(n(),S(s(re),{size:"xxs",state:o.state,title:"Delete Security Scheme"},{default:a(()=>[w("p",Oe," This cannot be undone. You're about to delete the "+T(o.scheme?.label)+" security scheme from the collection. ",1),w("div",ze,[c(s(B),{class:"flex h-8 cursor-pointer items-center gap-1.5 px-3 shadow-none focus:outline-none",type:"button",variant:"outlined",onClick:p[0]||(p[0]=i=>h("close"))},{default:a(()=>[...p[1]||(p[1]=[b(" Cancel ",-1)])]),_:1}),c(s(B),{class:"flex h-8 cursor-pointer items-center gap-1.5 px-3 shadow-none focus:outline-none",type:"submit",onClick:k},{default:a(()=>[b(" Delete "+T(o.scheme?.label),1)]),_:1})])]),_:1},8,["state"]))}}),le=(l,U,f,{securitySchemeMutators:h,securitySchemes:x},k=!1)=>{if(h.edit(l,U,f),!!k)try{const o=JSON.parse(F().getItem(P.AUTH)??"{}"),p=x[l];if(o&&p?.nameKey){const i=o[p.nameKey]||={};i[U]=f,F().setItem(P.AUTH,JSON.stringify(o))}}catch(o){console.error(o)}},Te=(l,U)=>{try{const{collectionMutators:f,securitySchemes:h,securitySchemeMutators:x}=l,k=JSON.parse(F().getItem(P.AUTH)??"{}"),o=Object.keys(h).reduce((i,t)=>{const e=h[t];return e&&(i[e.nameKey]=e.uid),i},{});Object.entries(k).forEach(([i,t])=>{const e=o[i];e&&Object.entries(t).forEach(([r,u])=>{x.edit(e,r,u)})});const p=JSON.parse(F().getItem(P.SELECTED_SECURITY_SCHEMES)??"[]").map(i=>Array.isArray(i)?i.map(t=>o[t]).filter(Q):o[i]).filter(Q);f.edit(U,"selectedSecuritySchemeUids",p)}catch(f){console.error(f)}},Ie={class:"flex h-fit w-full"},Re={class:"flex-1"},Be={class:"flex items-center gap-1.75"},Ee={class:"grid auto-rows-auto",style:{gridTemplateColumns:"1fr auto"}},qe={key:0},je={class:"font-code text-xs"},Me=E({__name:"OAuthScopesInput",props:{flow:{},updateScheme:{type:Function}},setup(l){const U=I(()=>Object.entries(l.flow?.scopes??{}).map(([p,i])=>({id:p,label:p,description:i}))),f=I(()=>l.flow?.selectedScopes||[]);function h(p,i){i?l.updateScheme(`flows.${l.flow.type}.selectedScopes`,[...f.value,p]):l.updateScheme(`flows.${l.flow.type}.selectedScopes`,f.value.filter(t=>t!==p))}const x=I(()=>l.flow?.selectedScopes?.length===Object.keys(l.flow?.scopes??{}).length),k=()=>{l.updateScheme(`flows.${l.flow.type}.selectedScopes`,Object.keys(l.flow?.scopes??{}))},o=()=>{l.updateScheme(`flows.${l.flow.type}.selectedScopes`,[])};return(p,i)=>(n(),S(s(J),{class:"h-auto !max-h-[initial] min-h-8 items-center"},{default:a(()=>[w("div",Ie,[i[2]||(i[2]=w("div",{class:"text-c-1 h-full items-center"},null,-1)),c(s(ne),{as:"div",class:"bl flex w-full flex-col"},{default:a(()=>[c(s(ce),{class:R(["group/scopes-accordion hover:text-c-1 flex h-auto min-h-8 cursor-pointer items-center gap-1.5 pr-2.25 pl-3 text-left",(p.flow?.selectedScopes?.length||0)>0?"text-c-1":"text-c-3"])},{default:a(({open:t})=>[w("div",Re," Scopes Selected "+T(p.flow?.selectedScopes?.length||0)+" / "+T(Object.keys(p.flow?.scopes??{}).length||0),1),w("div",Be,[x.value?(n(),S(s(B),{key:0,class:"pr-0.75 pl-1 transition-none",size:"sm",variant:"ghost",onClick:Y(o,["stop"])},{default:a(()=>[...i[0]||(i[0]=[b(" Deselect All ",-1)])]),_:1})):g("",!0),x.value?g("",!0):(n(),S(s(B),{key:1,class:"pr-0.75 pl-1 transition-none",size:"sm",variant:"ghost",onClick:Y(k,["stop"])},{default:a(()=>[...i[1]||(i[1]=[b(" Select All ",-1)])]),_:1})),c(s(ie),{class:"text-c-3 group-hover/scopes-accordion:text-c-2",icon:t?"ChevronDown":"ChevronRight",size:"md"},null,8,["icon"])])]),_:1},8,["class"]),c(s(ue),{as:"template"},{default:a(()=>[w("table",Ee,[(n(!0),y(C,null,D(U.value,({id:t,label:e,description:r})=>(n(),S(s(V),{key:t,class:"text-c-2",onClick:u=>h(t,!f.value.includes(t))},{default:a(()=>[c(s(J),{class:"hover:text-c-1 box-border !max-h-[initial] w-full cursor-pointer px-3 py-1.5"},{default:a(()=>[r?(n(),y("div",qe,[w("span",je,T(e),1),b(" â€“ "+T(r),1)])):g("",!0)]),_:2},1024),c(s(de),{modelValue:f.value.includes(t),"onUpdate:modelValue":()=>{}},null,8,["modelValue"])]),_:2},1032,["onClick"]))),128))])]),_:1})]),_:1})])]),_:1}))}}),Le=["for"],z=E({__name:"RequestAuthDataTableInput",props:{type:{},containerClass:{},required:{type:Boolean,default:!1},modelValue:{},readOnly:{type:Boolean,default:!1},environment:{},envVariables:{},workspace:{}},emits:["update:modelValue","inputFocus","inputBlur","selectVariable"],setup(l,{emit:U}){const f=l,h=U,x=Z();return(k,o)=>(n(),S(pe,A({id:s(x),canAddCustomEnumValue:!f.readOnly,containerClass:f.containerClass},k.$attrs,{envVariables:f.envVariables,environment:f.environment,lineWrapping:"",modelValue:f.modelValue,readOnly:f.readOnly,required:f.required,type:f.type,workspace:f.workspace,onInputBlur:o[0]||(o[0]=p=>h("inputBlur")),onInputFocus:o[1]||(o[1]=p=>h("inputFocus")),onSelectVariable:o[2]||(o[2]=p=>h("selectVariable",p)),"onUpdate:modelValue":o[3]||(o[3]=p=>h("update:modelValue",p))}),{default:a(()=>[w("label",{for:s(x)},[M(k.$slots,"default")],8,Le)]),icon:a(()=>[M(k.$slots,"icon")]),_:3},16,["id","canAddCustomEnumValue","containerClass","envVariables","environment","modelValue","readOnly","required","type","workspace"]))}}),De={class:"flex h-8 items-center justify-end border-t"},Fe={class:"flex h-8 w-full items-center justify-end border-t"},Pe=E({__name:"OAuth2",props:{collection:{},environment:{},envVariables:{},flow:{},persistAuth:{type:Boolean,default:!1},scheme:{},server:{},workspace:{}},emits:["authorized"],setup(l,{emit:U}){const f=U,h=me(),{toast:x}=he(),k=N(),o=(t,e)=>le(l.scheme.uid,t,e,k,l.persistAuth),p=async()=>{if(h.isLoading||!l.collection?.uid)return;if(!l.server){x("No server selected","error");return}h.startLoading();const[t,e]=await ye(l.flow,l.server,l.workspace?.proxyUrl).finally(()=>h.stopLoading());e?(o(`flows.${l.flow.type}.token`,e),f("authorized")):(console.error(t),x(t?.message??"Failed to authorize","error"))},i={environment:l.environment,envVariables:l.envVariables,workspace:l.workspace};return(t,e)=>(n(),y(C,null,[t.flow.token?(n(),y(C,{key:0},[c(s(V),null,{default:a(()=>[c(z,A(i,{class:"border-r-transparent",modelValue:t.flow.token,placeholder:"QUxMIFlPVVIgQkFTRSBBUkUgQkVMT05HIFRPIFVT",type:"password","onUpdate:modelValue":e[0]||(e[0]=r=>o(`flows.${t.flow.type}.token`,r))}),{default:a(()=>[...e[10]||(e[10]=[b(" Access Token ",-1)])]),_:1},16,["modelValue"])]),_:1}),c(s(V),{class:"min-w-full"},{default:a(()=>[w("div",De,[c(s(B),{class:"mr-1 p-0 px-2 py-0.5",loading:s(h),size:"sm",variant:"outlined",onClick:e[1]||(e[1]=r=>o(`flows.${t.flow.type}.token`,""))},{default:a(()=>[...e[11]||(e[11]=[b(" Clear ",-1)])]),_:1},8,["loading"]),M(t.$slots,"oauth-actions")])]),_:3})],64)):(n(),y(C,{key:1},[c(s(V),null,{default:a(()=>["authorizationUrl"in t.flow?(n(),S(z,A({key:0},i,{containerClass:"border-r-0",modelValue:t.flow.authorizationUrl,placeholder:"https://galaxy.scalar.com/authorize","onUpdate:modelValue":e[2]||(e[2]=r=>o(`flows.${t.flow.type}.authorizationUrl`,r))}),{default:a(()=>[...e[12]||(e[12]=[b(" Auth URL ",-1)])]),_:1},16,["modelValue"])):g("",!0),"tokenUrl"in t.flow?(n(),S(z,A({key:1},i,{modelValue:t.flow.tokenUrl,placeholder:"https://galaxy.scalar.com/token","onUpdate:modelValue":e[3]||(e[3]=r=>o(`flows.${t.flow.type}.tokenUrl`,r))}),{default:a(()=>[...e[13]||(e[13]=[b(" Token URL ",-1)])]),_:1},16,["modelValue"])):g("",!0)]),_:1}),"x-scalar-redirect-uri"in t.flow?(n(),S(s(V),{key:0},{default:a(()=>[c(z,A(i,{modelValue:t.flow["x-scalar-redirect-uri"],placeholder:"https://galaxy.scalar.com/callback","onUpdate:modelValue":e[4]||(e[4]=r=>o(`flows.${t.flow.type}.x-scalar-redirect-uri`,r))}),{default:a(()=>[...e[14]||(e[14]=[b(" Redirect URL ",-1)])]),_:1},16,["modelValue"])]),_:1})):g("",!0),t.flow.type==="password"?(n(),y(C,{key:1},[c(s(V),null,{default:a(()=>[c(z,A(i,{class:"text-c-2",modelValue:t.flow.username,placeholder:"janedoe","onUpdate:modelValue":e[5]||(e[5]=r=>o(`flows.${t.flow.type}.username`,r))}),{default:a(()=>[...e[15]||(e[15]=[b(" Username ",-1)])]),_:1},16,["modelValue"])]),_:1}),c(s(V),null,{default:a(()=>[c(z,A(i,{modelValue:t.flow.password,placeholder:"********",type:"password","onUpdate:modelValue":e[6]||(e[6]=r=>o(`flows.${t.flow.type}.password`,r))}),{default:a(()=>[...e[16]||(e[16]=[b(" Password ",-1)])]),_:1},16,["modelValue"])]),_:1})],64)):g("",!0),c(s(V),null,{default:a(()=>[c(z,A(i,{modelValue:t.flow["x-scalar-client-id"],placeholder:"12345","onUpdate:modelValue":e[7]||(e[7]=r=>o(`flows.${t.flow.type}.x-scalar-client-id`,r))}),{default:a(()=>[...e[17]||(e[17]=[b(" Client ID ",-1)])]),_:1},16,["modelValue"])]),_:1}),"clientSecret"in t.flow?(n(),S(s(V),{key:2},{default:a(()=>[c(z,A(i,{modelValue:t.flow.clientSecret,placeholder:"XYZ123",type:"password","onUpdate:modelValue":e[8]||(e[8]=r=>o(`flows.${t.flow.type}.clientSecret`,r))}),{default:a(()=>[...e[18]||(e[18]=[b(" Client Secret ",-1)])]),_:1},16,["modelValue"])]),_:1})):g("",!0),"x-usePkce"in t.flow?(n(),S(s(V),{key:3},{default:a(()=>[c(z,A(i,{enum:s(fe),modelValue:t.flow["x-usePkce"],readOnly:"","onUpdate:modelValue":e[9]||(e[9]=r=>o(`flows.${t.flow.type}.x-usePkce`,r))}),{default:a(()=>[...e[19]||(e[19]=[b(" Use PKCE ",-1)])]),_:1},16,["enum","modelValue"])]),_:1})):g("",!0),Object.keys(t.flow.scopes??{}).length?(n(),S(s(V),{key:4},{default:a(()=>[c(Me,{flow:t.flow,updateScheme:o},null,8,["flow"])]),_:1})):g("",!0)],64)),t.flow.token?g("",!0):(n(),S(s(V),{key:2,class:"min-w-full"},{default:a(()=>[w("div",Fe,[c(s(B),{class:"mr-0.75 p-0 px-2 py-0.5",loading:s(h),size:"sm",variant:"outlined",onClick:p},{default:a(()=>[...e[20]||(e[20]=[b(" Authorize ",-1)])]),_:1},8,["loading"])])]),_:1}))],64))}}),Ne={class:"bg-b-1 text-c-2 outline-b-3 top-0 z-1 h-full w-full overflow-hidden px-3 py-1.25 text-ellipsis group-hover/auth:absolute group-hover/auth:h-auto group-hover/auth:border-b *:first:line-clamp-1 *:first:text-ellipsis group-hover/auth:*:first:line-clamp-none"},Ke={key:0,class:"flex min-h-8 border-t text-base"},He={class:"flex h-8 max-w-full gap-2.5 overflow-x-auto px-3"},Qe=["onClick"],Ye={class:"relative z-10"},Je=E({__name:"RequestAuthTab",props:{collection:{},environment:{},envVariables:{},layout:{},persistAuth:{type:Boolean,default:!1},securitySchemeUids:{},server:{},workspace:{}},emits:["authorized"],setup(l,{emit:U}){const f=U,h=N(),{securitySchemes:x}=h,k=I(()=>l.securitySchemeUids.map(e=>({scheme:x[e]}))),o=j(""),p=e=>{const r=e.description?`: ${e.description}`:"",u=`${H(e.nameKey)}${r||`: ${e.type}`}`;if(e.type==="apiKey")return`${H(e.nameKey)}${r||`: ${e.in}`}`;if(e.type==="oauth2"){const _=Object.values(e.flows??{})[0];return`${H(e.nameKey)}: ${o.value?o.value:_?.type??""}${r}`}return e.type==="http"?`${H(e.nameKey)}: ${e.scheme}${r}`:`${u}${r}`},i=(e,r,u)=>{le(e,r,u,h,l.persistAuth)};ve(()=>{l.persistAuth&&Te(h,l.collection.uid)});const t={environment:l.environment,envVariables:l.envVariables,workspace:l.workspace};return(e,r)=>(n(!0),y(C,null,D(k.value,({scheme:u})=>(n(),y(C,{key:u?.uid},[k.value.length>1&&u?(n(),S(s(V),{key:0},{default:a(()=>[c(s(J),{"aria-label":p(u),class:"text-c-2 group/auth flex items-center leading-[22px] whitespace-nowrap outline-none hover:whitespace-normal"},{default:a(()=>[w("p",Ne,T(p(u)),1)]),_:2},1032,["aria-label"])]),_:2},1024)):g("",!0),u?.description&&k.value.length<=1?(n(),S(s(V),{key:1},{default:a(()=>[c(s(J),{"aria-label":u.description,class:"max-h-[auto]"},{default:a(()=>[c(s(be),{class:"auth-description bg-b-1 text-c-2 min-w-0 flex-1 px-3 py-1.25",value:u.description},null,8,["value"])]),_:2},1032,["aria-label"])]),_:2},1024)):g("",!0),u?.type==="http"?(n(),y(C,{key:2},[u.scheme==="bearer"?(n(),S(s(V),{key:0},{default:a(()=>[c(z,A({ref_for:!0},t,{containerClass:e.layout==="reference"&&"border-t",modelValue:u.token,placeholder:"Token",type:"password","onUpdate:modelValue":_=>i(u.uid,"token",_)}),{default:a(()=>[...r[1]||(r[1]=[b(" Bearer Token ",-1)])]),_:1},16,["containerClass","modelValue","onUpdate:modelValue"])]),_:2},1024)):u?.scheme==="basic"?(n(),y(C,{key:1},[c(s(V),null,{default:a(()=>[c(z,A({ref_for:!0},t,{class:"text-c-2",modelValue:u.username,placeholder:"janedoe",required:"","onUpdate:modelValue":_=>i(u.uid,"username",_)}),{default:a(()=>[...r[2]||(r[2]=[b(" Username ",-1)])]),_:1},16,["modelValue","onUpdate:modelValue"])]),_:2},1024),c(s(V),null,{default:a(()=>[c(z,A({ref_for:!0},t,{modelValue:u.password,placeholder:"********",type:"password","onUpdate:modelValue":_=>i(u.uid,"password",_)}),{default:a(()=>[...r[3]||(r[3]=[b(" Password ",-1)])]),_:1},16,["modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):g("",!0)],64)):u?.type==="apiKey"?(n(),y(C,{key:3},[c(s(V),null,{default:a(()=>[c(z,A({ref_for:!0},t,{containerClass:e.layout==="reference"&&"border-t",modelValue:u.name,placeholder:"api-key","onUpdate:modelValue":_=>i(u.uid,"name",_)}),{default:a(()=>[...r[4]||(r[4]=[b(" Name ",-1)])]),_:1},16,["containerClass","modelValue","onUpdate:modelValue"])]),_:2},1024),c(s(V),null,{default:a(()=>[c(z,A({ref_for:!0},t,{modelValue:u.value,placeholder:"QUxMIFlPVVIgQkFTRSBBUkUgQkVMT05HIFRPIFVT",type:"password","onUpdate:modelValue":_=>i(u.uid,"value",_)}),{default:a(()=>[...r[5]||(r[5]=[b(" Value ",-1)])]),_:1},16,["modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):u?.type==="oauth2"?(n(),y(C,{key:4},[c(s(V),null,{default:a(()=>[Object.keys(u.flows).length>1?(n(),y("div",Ke,[w("div",He,[(n(!0),y(C,null,D(u?.flows,(_,O,q)=>(n(),y("button",{key:O,class:R(["floating-bg text-c-3 relative cursor-pointer border-b-[1px] border-transparent py-1 text-base font-medium",{"!text-c-1 !rounded-none border-b-[1px] !border-current":e.layout!=="reference"&&(o.value===O||q===0&&!o.value),"!text-c-1 !rounded-none border-b-[1px] !border-current opacity-100":e.layout==="reference"&&(o.value===O||q===0&&!o.value)}]),type:"button",onClick:K=>o.value=O},[w("span",Ye,T(O),1)],10,Qe))),128))])])):g("",!0)]),_:2},1024),(n(!0),y(C,null,D(u?.flows,(_,O,q)=>(n(),y(C,{key:O},[o.value===O||q===0&&!o.value?(n(),S(Pe,A({key:0,ref_for:!0},t,{collection:e.collection,flow:_,persistAuth:e.persistAuth,scheme:u,server:e.server,workspace:e.workspace,onAuthorized:r[0]||(r[0]=K=>f("authorized"))}),{"oauth-actions":a(()=>[M(e.$slots,"oauth-actions")]),_:3},16,["collection","flow","persistAuth","scheme","server","workspace"])):g("",!0)],64))),128))],64)):u?.type==="openIdConnect"?(n(),y("div",{key:5,class:R(["text-c-3 bg-b-1 flex min-h-[calc(4rem+1px)] items-center justify-center border-t border-b-0 px-4 text-base",{"rounded-b-lg":e.layout==="reference"}])}," Coming soon ",2)):g("",!0)],64))),128))}}),We=["onClick"],Xe={class:"relative z-10 font-medium whitespace-nowrap"},Ze={key:0,class:"absolute inset-x-1 bottom-[var(--scalar-border-width)] left-1/2 z-1 h-px w-full -translate-x-1/2 bg-current"},Ge=E({__name:"RequestAuthDataTable",props:{collection:{},environment:{},envVariables:{},layout:{default:"client"},persistAuth:{type:Boolean,default:!1},selectedSchemeOptions:{default:()=>[]},server:{},workspace:{}},emits:["authorized","activeSchemes"],setup(l,{emit:U}){const f=U,{securitySchemes:h}=N(),x=G(),k=j(null),o=j(0),p=I(()=>{if(!l.selectedSchemeOptions||l.selectedSchemeOptions.length===0)return[];const t=l.selectedSchemeOptions[o.value];if(!t)return[];const e=t.id.split(",").filter(Boolean);return e.length>1?e:[t.id]});X(p,t=>{f("activeSchemes",t.map(e=>h[e]).filter(Q))},{immediate:!0});const i=I(()=>p.value.length>0);return X(()=>l.selectedSchemeOptions,t=>{(!t||!t[o.value])&&(o.value=Math.max(0,o.value-1))}),(t,e)=>(n(),y("form",{onSubmit:e[2]||(e[2]=Y(()=>{},["prevent"]))},[t.selectedSchemeOptions.length>1?(n(),y("div",{key:0,class:R(["box-content flex flex-wrap gap-x-2.5 overflow-hidden border border-b-0 px-3",t.layout==="client"&&"border-x-0"])},[(n(!0),y(C,null,D(t.selectedSchemeOptions,(r,u)=>(n(),y("div",{key:r.id,class:R(["relative z-1 -mb-[var(--scalar-border-width)] flex h-8 cursor-pointer",[o.value===u?"text-c-1":"text-c-3"]])},[w("button",{class:"floating-bg relative cursor-pointer border-b-[1px] border-transparent py-1 text-sm font-medium",type:"button",onClick:_=>o.value=u},[w("span",Xe,T(r.label),1)],8,We),o.value===u?(n(),y("div",Ze)):g("",!0)],2))),128))],2)):g("",!0),i.value?(n(),S(s(we),{key:1,class:R(["flex-1",t.layout==="reference"&&"bg-b-1 rounded-b-lg border border-t-0"]),columns:[""],presentational:""},{default:a(()=>[c(Je,{collection:t.collection,envVariables:t.envVariables,environment:t.environment,layout:t.layout,persistAuth:t.persistAuth,securitySchemeUids:p.value,server:t.server,workspace:t.workspace,onAuthorized:e[0]||(e[0]=r=>f("authorized"))},{"oauth-actions":a(()=>[M(t.$slots,"oauth-actions",{},void 0,!0)]),_:3},8,["collection","envVariables","environment","layout","persistAuth","securitySchemeUids","server","workspace"])]),_:3},8,["class"])):(n(),y("div",{key:2,class:R(["text-c-3 bg-b-1 flex min-h-16 items-center justify-center border-t px-4 text-sm",t.layout==="reference"&&"min-h-[calc(4rem+0.5px)] rounded-b-lg border"])}," No authentication selected ",2)),c(te,{scheme:k.value,state:s(x),onClose:e[1]||(e[1]=r=>s(x).hide())},null,8,["scheme","state"])],32))}}),et=ee(Ge,[["__scopeId","data-v-0bb98074"]]),tt=["id"],lt={class:"flex flex-1"},at={class:"min-w-0 flex-1 truncate"},ot=E({__name:"RequestAuth",props:{collection:{},isReadOnly:{type:Boolean,default:!1},environment:{},envVariables:{},layout:{},operation:{},persistAuth:{type:Boolean,default:!1},selectedSecuritySchemeUids:{},server:{},title:{},workspace:{}},emits:["authorized","activeSchemes"],setup(l,{emit:U}){const f=U,{securitySchemes:h,securitySchemeMutators:x,requestMutators:k,collectionMutators:o}=N(),p=Z(),i=j(null),t=G(),e=j(null),r=j(!1),u=I(()=>{const m=xe(l.operation,l.collection);return{filteredRequirements:m.filter(d=>Object.keys(d).length),requirements:m}}),_=I(()=>{const{filteredRequirements:m,requirements:d}=u.value;if(!d.length)return null;const v=!d.some($=>Object.keys($).length>1)&&m.length<d.length;return{icon:v?"Unlock":"Lock",text:v?"Optional":"Required"}}),O=I(()=>l.selectedSecuritySchemeUids.map(m=>{if(Array.isArray(m))return ke(m,h);const d=h[m??""];if(d)return ge(d)}).filter(Q));function q(m){const d=m.find($=>$.payload),v=m.filter($=>!$.payload).map(({id:$})=>{const L=$.split(",");return L.length>1?L:$});if(d?.payload){const $=x.add(d.payload,l.collection?.uid);$&&v.push($.uid)}K(v)}const K=m=>{if(l.collection.useCollectionSecurity){if(o.edit(l.collection.uid,"selectedSecuritySchemeUids",m),!l.persistAuth)return;const d=m.map(v=>Array.isArray(v)?v.map($=>h[$]?.nameKey):h[v]?.nameKey);F().setItem(P.SELECTED_SECURITY_SCHEMES,JSON.stringify(d))}else l.operation?.uid&&k.edit(l.operation.uid,"selectedSecuritySchemeUids",m)};function W({id:m,label:d}){e.value={id:m,label:d},t.show()}const ae=m=>{if(!m)return;const d=l.selectedSecuritySchemeUids.filter(v=>{const $=m.split(",");return $.length>1&&Array.isArray(v)&&$.length===v.length?v.every(L=>!$.includes(L)):v!==m});K(d),i.value?.$el.focus(),t.hide()},oe=I(()=>Ve(u.value.filteredRequirements,l.collection?.securitySchemes??[],h,l.isReadOnly)),se=m=>{r.value&&m.stopPropagation(),i.value?.$el.click()};return(m,d)=>(n(),S(Ae,{class:"group/params relative",itemCount:O.value.length,layout:m.layout,"onUpdate:modelValue":d[4]||(d[4]=v=>r.value=v)},{title:a(()=>[w("div",{id:s(p),class:"inline-flex items-center gap-0.5 leading-[20px]"},[w("span",null,T(m.title),1),_.value?(n(),y("span",{key:0,class:R(["text-c-3 hover:bg-b-3 hover:text-c-1 -mr-1 cursor-pointer rounded px-1 py-0.5 text-xs leading-[normal]",{"text-c-1":_.value.text==="Required"}]),onClick:se},T(_.value.text),3)):g("",!0)],8,tt)]),actions:a(()=>[w("div",lt,[c(s(Se),{class:"w-72 text-xs",modelValue:O.value,multiple:"",options:oe.value,placement:"bottom-end",teleport:"",onDelete:W,"onUpdate:modelValue":q},{option:a(({option:v,selected:$})=>[c(s($e),{multiselect:"",selected:$},null,8,["selected"]),w("div",at,T(v.label),1),v.isDeletable??!m.isReadOnly?(n(),S(s(Ue),{key:0,class:"-m-0.5 shrink-0 p-0.5 opacity-0 group-hover/item:opacity-100",icon:s(Ce),label:`Delete ${v.label}`,size:"xs",onClick:Y(L=>W(v),["stop"])},null,8,["icon","label","onClick"])):g("",!0)]),default:a(()=>[c(s(B),{ref_key:"comboboxButtonRef",ref:i,"aria-describedby":s(p),class:"group/combobox-button hover:text-c-1 text-c-2 flex h-fit w-full items-center gap-1 px-0.75 py-0.25 text-base font-normal transition-transform",variant:"ghost"},{default:a(()=>[O.value.length===1?(n(),y(C,{key:0},[d[5]||(d[5]=w("span",{class:"sr-only"},"Selected Auth Type:",-1)),b(" "+T(O.value[0]?.label),1)],64)):O.value.length>1?(n(),y(C,{key:1},[d[6]||(d[6]=b(" Multiple ",-1)),d[7]||(d[7]=w("span",{class:"sr-only"},"Auth Types Selected",-1))],64)):(n(),y(C,{key:2},[d[8]||(d[8]=w("span",{class:"sr-only"},"Select",-1)),d[9]||(d[9]=b(" Auth Type ",-1))],64)),c(s(_e),{class:"size-3 shrink-0 transition-transform duration-100 group-aria-expanded/combobox-button:rotate-180",weight:"bold"})]),_:1},8,["aria-describedby"])]),_:1},8,["modelValue","options"])])]),default:a(()=>[c(et,{collection:m.collection,envVariables:m.envVariables,environment:m.environment,layout:m.layout,persistAuth:m.persistAuth,selectedSchemeOptions:O.value,server:m.server,workspace:m.workspace,onActiveSchemes:d[0]||(d[0]=v=>f("activeSchemes",v)),onAuthorized:d[1]||(d[1]=v=>f("authorized"))},{"oauth-actions":a(()=>[M(m.$slots,"oauth-actions",{},void 0,!0)]),_:3},8,["collection","envVariables","environment","layout","persistAuth","selectedSchemeOptions","server","workspace"]),c(te,{scheme:e.value,state:s(t),onClose:d[2]||(d[2]=v=>s(t).hide()),onDelete:d[3]||(d[3]=v=>ae(e.value?.id))},null,8,["scheme","state"])]),_:3},8,["itemCount","layout"]))}}),rt=ee(ot,[["__scopeId","data-v-3f1067a4"]]);export{rt as f};
